{% extends 'main.html' %}
{% load staticfiles %}
{% block style %}
<link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" media="all" />

 

{% endblock %}
{% block content %}
<section class="content">



			<div class="wraper container-fluid">
                <div class="page-title"> 
                    <h3 class="title">Создание нового сообщения</h3> 
                </div>
                  <form  id = 'f' role="form" method="post" enctype="multipart/form-data" >

									<input id = 'ss' name ='names' style='display:none' value ='sss' > </input>
                <div class="row">
                		<div class="col-md-10  col-sm-9">
						<div class="panel panel-default m-t-20">
							<div class="panel-body p-t-10">
				
  						 {% csrf_token %}


									<div class="form-group">
  

	<div class="row">
	  		<div class="col-md-4  col-sm-4">
<p> 	Кому: </p> <input type = "text" class = "form-control" list="json-datalist" id = "txtSearch" name = "TxtSearch" > 
	<datalist id="json-datalist"></datalist>


	</div>




			<div class="col-md-4  col-sm-4 names">
	

	</div>
</div>
  		Секретность:			 {{ form_massage.secrecy }}
</div>
							<!--			<input type="email" class="form-control" placeholder="To"> --> 
									
									<div class="form-group">
									<!-- 	<input type="text" class="form-control" placeholder="title "> -->
 				Заголовок:						 {{ form_massage.title }} 
									</div>
									<div class="form-group">
								<!-- 		<textarea class="wysihtml5 form-control" placeholder="Message body" style="height: 200px"></textarea> -->
							Сообщение:		
									{{ form_massage.body  }}
									</div>
										<button class="btn btn-purple"  >
										 <input  id = 'btn' type="submit" value="OK">
									
										</button>
								</form>
							</div>
							<!-- panel -body -->
						</div>

                  

						<!-- panel -->
					</div> <!-- col 12 --> 


					<div class="col-md-2 col-sm-3" >
	 <div id = "upload-container">
               <input id="file-input" type="file" name="file_field" multiple>
               <label for="file-input">Файл</label>
          </div>
					</div>
                </div> <!-- End row --> 

            </div> <!-- END Wraper -->

		

		</section>

{% block js%}


<script  src="https://code.jquery.com/ui/1.12.1/jquery-ui.js" ></script>
<script>


	

 $(function(){

	
var ret_name = function(){
	let mass = []
	$('.names > p').each(function(){
			mass.push(this.innerText)
	})
		return mass
}



$('#btn').click(function () {
		 $('#ss')[0].value =  ret_name()
});




closel =  function (event){
$('[data-id=' + event + ']').remove()
}

var arr = ['id_file_fild', 'id_title', 'id_body', 'id_users', 'form_control']
$.each(arr,function(index,value){
	eval(`$("#${value}")`).addClass("form-control")
})


var dataList = document.getElementById('json-datalist');
var input = document.getElementById('#txtSearch');

 function AutoCompleteSelectHandler(event, ui)
  {
  var selectedObj = ui.item;

	
	let p = 	"<p class='new' data-id =" + "'" +  ui.item["pk"]  + "'" +    "data-sec='" +  ui.item["sec"]  + "'" +    " > " +  ui.item["label"] + '<buttuon onclick="closel' +  '(' + ui.item["pk"] +  ')"' + 'class ="close"' + "data-fg=" + "'" +  ui.item["pk"]  + "'" + "></button></p>"

			$('.names').append(p) ;
	console.log(ui.item)
 }


 $ ("#txtSearch").autocomplete({ 

	   source:'{% url "searchmessage" %}', 
                minLength: 2,
								  select: function (event, ui) { //item selected
    AutoCompleteSelectHandler(event, ui)


  },
            
 });
 
});   

   
 

		 </script>
{% endblock %}

<style> 

ui{
	background-color :red;
}

.names{
	    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
}
 	.new {
		background-color: rgb(244,233,111);
	  width: max-content;
		height:max-content;
    padding: 3px 7px;
    color: #333;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;
    border: 0.2px solid #666;
		position: relative;
   }
	 .close{
		 height:8px;
		 width:8px;
		 cursor:pointer;
		 background-color: grey;
		 left:110%;
		 z-index: 99999;

	 }
</style>

{% endblock %}



        
